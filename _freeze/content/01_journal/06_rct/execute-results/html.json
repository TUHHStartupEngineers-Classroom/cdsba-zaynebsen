{
  "hash": "0c4563acc4d8d5644f82d574a6e3b5a8",
  "result": {
    "markdown": "---\ntitle: \"Randomized Controlled Trials\"\n---\n\n::: {.cell hash='06_rct_cache/html/unnamed-chunk-1_1a9d44e579b9feafd20b96a5aa5fddb9'}\n\n```{.r .cell-code}\nlibrary(ggplot2)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: le package 'ggplot2' a été compilé avec la version R 4.3.2\n```\n:::\n\n```{.r .cell-code}\nabtest_online <- readRDS(\"abtest_online.rds\")\ncompare_chatbot <- \n  ggplot(abtest_online, \n         aes(x = purchase, \n             y = chatbot, \n             color = as.factor(purchase))) +\n  stat_summary(geom = \"errorbar\", \n               width = 1,\n               fun.data = \"mean_se\", \n               fun.args = list(mult=1.96),\n               show.legend = F) +\n  labs(x = NULL, y = \"chatbot\", title = \"Difference in chatbot\")\n\ncompare_previous_visit <- \n  ggplot(abtest_online, \n         aes(x = purchase, \n             y = previous_visit, \n             color = as.factor(purchase))) +\n  stat_summary(geom = \"errorbar\", \n               width = 1,\n               fun.data = \"mean_se\", \n               fun.args = list(mult=1.96),\n               show.legend = F) +\n  labs(x = NULL, y = \"previous_visit\", title = \"Difference in previous_visit\")\n\ncompare_mobile_device <- \n  ggplot(abtest_online, \n         aes(x = purchase, \n             y = mobile_device, \n             color = as.factor(purchase))) +\n  stat_summary(geom = \"errorbar\", \n               width = 1,\n               fun.data = \"mean_se\", \n               fun.args = list(mult=1.96),\n               show.legend = F) +\n  labs(x = NULL, y = \"mobile_device\", title = \"Difference in mobile_device\")\n\ncompare_purchase_amount <- \n  ggplot(abtest_online, \n         aes(x = purchase, \n             y = purchase_amount, \n             color = as.factor(purchase))) +\n  stat_summary(geom = \"errorbar\", \n               width = 1,\n               fun.data = \"mean_se\", \n               fun.args = list(mult=1.96),\n               show.legend = F) +\n  labs(x = NULL, y = \"purchase_amount\", title = \"Difference in purchase_amount\")\n\ncompare_chatbot\n```\n\n::: {.cell-output-display}\n![](06_rct_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n\n```{.r .cell-code}\ncompare_previous_visit\n```\n\n::: {.cell-output-display}\n![](06_rct_files/figure-html/unnamed-chunk-1-2.png){width=672}\n:::\n\n```{.r .cell-code}\ncompare_mobile_device\n```\n\n::: {.cell-output-display}\n![](06_rct_files/figure-html/unnamed-chunk-1-3.png){width=672}\n:::\n\n```{.r .cell-code}\ncompare_purchase_amount\n```\n\n::: {.cell-output-display}\n![](06_rct_files/figure-html/unnamed-chunk-1-4.png){width=672}\n:::\n\n```{.r .cell-code}\nmodel <- lm(purchase_amount~chatbot, data= abtest_online)\nsummary(model)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> Call:\n#> lm(formula = purchase_amount ~ chatbot, data = abtest_online)\n#> \n#> Residuals:\n#>     Min      1Q  Median      3Q     Max \n#> -16.702 -14.478  -9.626  13.922  64.648 \n#> \n#> Coefficients:\n#>             Estimate Std. Error t value Pr(>|t|)    \n#> (Intercept)  16.7017     0.8374  19.944  < 2e-16 ***\n#> chatbotTRUE  -7.0756     1.1796  -5.998 2.79e-09 ***\n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> Residual standard error: 18.65 on 998 degrees of freedom\n#> Multiple R-squared:  0.0348,\tAdjusted R-squared:  0.03383 \n#> F-statistic: 35.98 on 1 and 998 DF,  p-value: 2.787e-09\n```\n:::\n:::\n\n::: {.cell hash='06_rct_cache/html/unnamed-chunk-2_cc9c3d6a79ed3f8b4e0a753446fa3b19'}\n\n```{.r .cell-code}\nlm_mod <- lm(purchase_amount ~ purchase * chatbot + purchase * previous_visit+purchase *mobile_device , data = abtest_online)\nsummary(lm_mod)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> Call:\n#> lm(formula = purchase_amount ~ purchase * chatbot + purchase * \n#>     previous_visit + purchase * mobile_device, data = abtest_online)\n#> \n#> Residuals:\n#>    Min     1Q Median     3Q    Max \n#> -32.22   0.00   0.00   0.00  48.40 \n#> \n#> Coefficients:\n#>                              Estimate Std. Error t value Pr(>|t|)    \n#> (Intercept)                 1.618e-13  7.633e-01   0.000   1.0000    \n#> purchase                    3.434e+01  1.084e+00  31.687   <2e-16 ***\n#> chatbotTRUE                 4.376e-15  7.410e-01   0.000   1.0000    \n#> previous_visit             -5.214e-15  1.984e-01   0.000   1.0000    \n#> mobile_deviceTRUE          -9.423e-15  7.668e-01   0.000   1.0000    \n#> purchase:chatbotTRUE        2.363e+00  1.214e+00   1.946   0.0519 .  \n#> purchase:previous_visit    -1.940e-01  2.794e-01  -0.694   0.4876    \n#> purchase:mobile_deviceTRUE -8.148e-01  1.252e+00  -0.651   0.5153    \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> Residual standard error: 8.911 on 992 degrees of freedom\n#> Multiple R-squared:  0.781,\tAdjusted R-squared:  0.7795 \n#> F-statistic: 505.4 on 7 and 992 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n::: {.cell hash='06_rct_cache/html/unnamed-chunk-3_2b3dc979318849c5db13c35f3d5523bb'}\n\n```{.r .cell-code}\nmodel<-glm(purchase~chatbot+previous_visit+mobile_device, family=binomial(link='logit'), abtest_online)\nsummary(model)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> \n#> Call:\n#> glm(formula = purchase ~ chatbot + previous_visit + mobile_device, \n#>     family = binomial(link = \"logit\"), data = abtest_online)\n#> \n#> Coefficients:\n#>                   Estimate Std. Error z value Pr(>|z|)    \n#> (Intercept)       -0.22185    0.12347  -1.797  0.07237 .  \n#> chatbotTRUE       -0.96894    0.13564  -7.144 9.09e-13 ***\n#> previous_visit     0.10606    0.03262   3.252  0.00115 ** \n#> mobile_deviceTRUE -0.07119    0.14530  -0.490  0.62417    \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> (Dispersion parameter for binomial family taken to be 1)\n#> \n#>     Null deviance: 1329.1  on 999  degrees of freedom\n#> Residual deviance: 1262.2  on 996  degrees of freedom\n#> AIC: 1270.2\n#> \n#> Number of Fisher Scoring iterations: 4\n```\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}